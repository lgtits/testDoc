import{b1 as H,a as N,ab as he,d as K,j as at,r as T,l as ge,o as c,e as p,g as l,t as y,F as C,aH as W,f as b,n as oe,q as pe,x as ae,aI as ye,aJ as we,_ as Q,h as Ye,b2 as ct,b3 as lt,p as R,w as ce,aM as ut,Q as dt,b4 as le,m as ve,b5 as _t,b6 as pt,b7 as mt,i as Ae,k as ft,Y as ht,a$ as Re,b0 as Ne,y as gt}from"./index.5760d8ee.js";import{_ as yt}from"./CommonModal.b63b8388.js";import{D as wt}from"./Dialog.18bc46bf.js";import{N as Fe}from"./Notify.7cd0848e.js";import{Q as Ze}from"./QExpansionItem.e7e1c4e7.js";import{v as vt}from"./Validations.c5400c5d.js";import{z as kt,j as $t,e as bt}from"./index.56bcdd36.js";import"./ClosePopup.460f652a.js";import"./Format.45ca4c10.js";import"./QItemSection.14344047.js";import"./QItemLabel.db1b8f90.js";var Et=Object.defineProperty,St=(e,t,s)=>t in e?Et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,E=(e,t,s)=>(St(e,typeof t!="symbol"?t+"":t,s),s),Ce=new Intl.Collator(0,{numeric:1}).compare;function Xe(e,t,s){return e=e.split("."),t=t.split("."),Ce(e[0],t[0])||Ce(e[1],t[1])||(t[2]=t.slice(2).join("."),s=/[.-]/.test(e[2]=e.slice(2).join(".")),s==/[.-]/.test(t[2])?Ce(e[2],t[2]):s?-1:1)}const It="upload",Dt="config",Ot="info",Tt="runtime",At="sleeptime",Rt="https://gradio-space-api-fetcher-v2.hf.space/api",xe="This application is currently busy. Please try again. ",re="Connection errored out. ",ue="Could not resolve app config. ",Nt="Could not get space status. ",Ct="Could not get API info. ",Bt="Space metadata could not be loaded. ";function et(e,t,s){return t.startsWith("http://")||t.startsWith("https://")?s?e:t:e+t}async function Lt(e,t){try{return(await(await fetch(`https://huggingface.co/api/spaces/${e}/jwt`,{headers:{Authorization:`Bearer ${t}`}})).json()).token||!1}catch{return!1}}function Pt(e){let t={};return e.forEach(({api_name:s},o)=>{s&&(t[s]=o)}),t}async function Mt(e){const t=this.options.hf_token?{Authorization:`Bearer ${this.options.hf_token}`}:{};if(t["Content-Type"]="application/json",typeof window<"u"&&window.gradio_config&&location.origin!=="http://localhost:9876"&&!window.gradio_config.dev_mode){const s=window.gradio_config.root,o=window.gradio_config;let n=et(e,o.root,!1);return o.root=n,{...o,path:s}}else if(e){const s=await this.fetch(`${e}/${Dt}`,{headers:t});if(s?.status===200){let o=await s.json();return o.path=o.path??"",o.root=e,o}throw new Error(ue)}throw new Error(ue)}function Be(e){if(e.startsWith("http")){const{protocol:t,host:s}=new URL(e);return s.endsWith("hf.space")?{ws_protocol:"wss",host:s,http_protocol:t}:{ws_protocol:t==="https:"?"wss":"ws",http_protocol:t,host:s}}else if(e.startsWith("file:"))return{ws_protocol:"ws",http_protocol:"http:",host:"lite.local"};return{ws_protocol:"wss",http_protocol:"https:",host:e}}const tt=/^[^\/]*\/[^\/]*$/,Ut=/.*hf\.space\/{0,1}$/;async function st(e,t){const s={};t&&(s.Authorization=`Bearer ${t}`);const o=e.trim();if(tt.test(o))try{const r=(await(await fetch(`https://huggingface.co/api/spaces/${o}/host`,{headers:s})).json()).host;return{space_id:e,...Be(r)}}catch(n){throw new Error("Space metadata could not be loaded. "+n.message)}if(Ut.test(o)){const{ws_protocol:n,http_protocol:r,host:i}=Be(o);return{space_id:i.replace(".hf.space",""),ws_protocol:n,http_protocol:r,host:i}}return{space_id:!1,...Be(o)}}function Ft(e,t,s){const o={named_endpoints:{},unnamed_endpoints:{}};return Object.keys(e).forEach(n=>{(n==="named_endpoints"||n==="unnamed_endpoints")&&(o[n]={},Object.entries(e[n]).forEach(([r,{parameters:i,returns:a}])=>{var f,m;const d=t.dependencies.findIndex(v=>v.api_name===r||v.api_name===r.replace("/",""))||s[r.replace("/","")]||-1,_=d!==-1?t.dependencies[d].types:{continuous:!1,generator:!1};if(d!==-1&&((m=(f=t.dependencies[d])==null?void 0:f.inputs)==null?void 0:m.length)!==i.length){const v=t.dependencies[d].inputs.map(B=>{var O;return(O=t.components.find(D=>D.id===B))==null?void 0:O.type});try{v.forEach((B,O)=>{if(B==="state"){const D={component:"state",example:null,parameter_default:null,parameter_has_default:!0,parameter_name:null,hidden:!0};i.splice(O,0,D)}})}catch{}}const u=(v,B,O,D)=>({...v,description:qt(v?.type,O),type:jt(v?.type,B,O,D)||""});o[n][r]={parameters:i.map(v=>u(v,v?.component,v?.serializer,"parameter")),returns:a.map(v=>u(v,v?.component,v?.serializer,"return")),type:_}}))}),o}function jt(e,t,s,o){switch(e?.type){case"string":return"string";case"boolean":return"boolean";case"number":return"number"}if(s==="JSONSerializable"||s==="StringSerializable")return"any";if(s==="ListStringSerializable")return"string[]";if(t==="Image")return o==="parameter"?"Blob | File | Buffer":"string";if(s==="FileSerializable")return e?.type==="array"?o==="parameter"?"(Blob | File | Buffer)[]":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}[]":o==="parameter"?"Blob | File | Buffer":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}";if(s==="GallerySerializable")return o==="parameter"?"[(Blob | File | Buffer), (string | null)][]":"[{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}, (string | null))][]"}function qt(e,t){return t==="GallerySerializable"?"array of [file, label] tuples":t==="ListStringSerializable"?"array of strings":t==="FileSerializable"?"array of files or single file":e?.description}function Le(e,t){switch(e.msg){case"send_data":return{type:"data"};case"send_hash":return{type:"hash"};case"queue_full":return{type:"update",status:{queue:!0,message:xe,stage:"error",code:e.code,success:e.success}};case"heartbeat":return{type:"heartbeat"};case"unexpected_error":return{type:"unexpected_error",status:{queue:!0,message:e.message,stage:"error",success:!1}};case"estimation":return{type:"update",status:{queue:!0,stage:t||"pending",code:e.code,size:e.queue_size,position:e.rank,eta:e.rank_eta,success:e.success}};case"progress":return{type:"update",status:{queue:!0,stage:"pending",code:e.code,progress_data:e.progress_data,success:e.success}};case"log":return{type:"log",data:e};case"process_generating":return{type:"generating",status:{queue:!0,message:e.success?null:e.output.error,stage:e.success?"generating":"error",code:e.code,progress_data:e.progress_data,eta:e.average_duration},data:e.success?e.output:null};case"process_completed":return"error"in e.output?{type:"update",status:{queue:!0,message:e.output.error,stage:"error",code:e.code,success:e.success}}:{type:"complete",status:{queue:!0,message:e.success?void 0:e.output.error,stage:e.success?"complete":"error",code:e.code,progress_data:e.progress_data},data:e.success?e.output:null};case"process_starts":return{type:"update",status:{queue:!0,stage:"pending",code:e.code,size:e.rank,position:0,success:e.success,eta:e.eta}}}return{type:"none",status:{stage:"error",queue:!0}}}const Wt=(e,t)=>{const s=Object.values(t.named_endpoints).flatMap(r=>r.parameters);if(Array.isArray(e))return e.length>s.length&&console.warn("Too many arguments provided for the endpoint."),e;const o=[],n=Object.keys(e);return s.forEach((r,i)=>{if(e.hasOwnProperty(r.parameter_name))o[i]=e[r.parameter_name];else if(r.parameter_has_default)o[i]=r.parameter_default;else throw new Error(`No value provided for required parameter: ${r.parameter_name}`)}),n.forEach(r=>{if(!s.some(i=>i.parameter_name===r))throw new Error(`Parameter \`${r}\` is not a valid keyword argument. Please refer to the API for usage.`)}),o.forEach((r,i)=>{if(r===void 0&&!s[i].parameter_has_default)throw new Error(`No value provided for required parameter: ${s[i].parameter_name}`)}),o};async function Gt(){if(this.api_info)return this.api_info;const{hf_token:e}=this.options,{config:t}=this,s={"Content-Type":"application/json"};if(e&&(s.Authorization=`Bearer ${e}`),!!t)try{let o;if(Xe(t?.version||"2.0.0","3.30")<0?o=await this.fetch(Rt,{method:"POST",body:JSON.stringify({serialize:!1,config:JSON.stringify(t)}),headers:s}):o=await this.fetch(`${t?.root}/${Ot}`,{headers:s}),!o.ok)throw new Error(re);let n=await o.json();return"api"in n&&(n=n.api),n.named_endpoints["/predict"]&&!n.unnamed_endpoints[0]&&(n.unnamed_endpoints[0]=n.named_endpoints["/predict"]),Ft(n,t,this.api_map)}catch(o){""+o.message}}async function zt(e,t,s){var o;const n={};(o=this==null?void 0:this.options)!=null&&o.hf_token&&(n.Authorization=`Bearer ${this.options.hf_token}`);const r=1e3,i=[];let a;for(let f=0;f<t.length;f+=r){const m=t.slice(f,f+r),d=new FormData;m.forEach(u=>{d.append("files",u)});try{const u=s?`${e}/upload?upload_id=${s}`:`${e}/${It}`;a=await this.fetch(u,{method:"POST",body:d,headers:n})}catch(u){throw new Error(re+u.message)}if(!a.ok){const u=await a.text();return{error:`HTTP ${a.status}: ${u}`}}const _=await a.json();_&&i.push(..._)}return{files:i}}async function Vt(e,t,s,o){let n=(Array.isArray(e)?e:[e]).map(i=>i.blob);const r=n.filter(i=>i.size>(o??1/0));if(r.length)throw new Error(`File size exceeds the maximum allowed size of ${o} bytes: ${r.map(i=>i.name).join(", ")}`);return await Promise.all(await this.upload_files(t,n,s).then(async i=>{if(i.error)throw new Error(i.error);return i.files?i.files.map((a,f)=>new nt({...e[f],path:a,url:t+"/file="+a})):[]}))}class nt{constructor({path:t,url:s,orig_name:o,size:n,blob:r,is_stream:i,mime_type:a,alt_text:f}){E(this,"path"),E(this,"url"),E(this,"orig_name"),E(this,"size"),E(this,"blob"),E(this,"is_stream"),E(this,"mime_type"),E(this,"alt_text"),E(this,"meta",{_type:"gradio.FileData"}),this.path=t,this.url=s,this.orig_name=o,this.size=n,this.blob=s?void 0:r,this.is_stream=i,this.mime_type=a,this.alt_text=f}}function Ve(e,t,s){for(;s.length>1;){const n=s.shift();if(typeof n=="string"||typeof n=="number")e=e[n];else throw new Error("Invalid key type")}const o=s.shift();if(typeof o=="string"||typeof o=="number")e[o]=t;else throw new Error("Invalid key type")}async function je(e,t=void 0,s=[],o=!1,n=void 0){if(Array.isArray(e)){let r=[];return await Promise.all(e.map(async i=>{var a;let f=s.slice();f.push(i);const m=await je(e[i],o?((a=n?.parameters[i])==null?void 0:a.component)||void 0:t,f,!1,n);r=r.concat(m)})),r}else{if(globalThis.Buffer&&e instanceof globalThis.Buffer||e instanceof Blob)return[{path:s,blob:t==="Image"?!1:new We([e]),type:t}];if(typeof e=="object"&&e!==null){let r=[];for(const i of Object.keys(e)){const a=[...s,i],f=e[i];r=r.concat(await je(f,void 0,a,!1,n))}return!r.length&&!(e instanceof Blob||e instanceof ArrayBuffer||e instanceof Uint8Array)?[{path:s,blob:new We([JSON.stringify(e)]),type:typeof e}]:r}}return[]}function Ht(e,t){var s,o;return((o=(s=t?.dependencies)==null?void 0:s[e])==null?void 0:o.queue)!==null?!t.dependencies[e].queue:!t.enable_queue}function Jt(e,t){return new Promise((s,o)=>{const n=new MessageChannel;n.port1.onmessage=({data:r})=>{n.port1.close(),s(r)},window.parent.postMessage(e,t,[n.port2])})}async function Kt(e,t,s){const o=this,n=await je(t,void 0,[],!0,s);return(await Promise.all(n.map(async({path:i,blob:a,type:f})=>{if(!a)return{path:i,type:f};const m=await o.upload_files(e,[a]),d=m.files&&m.files[0];return{path:i,file_url:d,type:f,name:a instanceof File?a?.name:void 0}}))).forEach(({path:i,file_url:a,type:f,name:m})=>{if(f==="Gallery")Ve(t,a,i);else if(a){const d=new nt({path:a,orig_name:m});Ve(t,d,i)}}),t}async function Qt(e,t,s){const o={"Content-Type":"application/json"};this.options.hf_token&&(o.Authorization=`Bearer ${this.options.hf_token}`);try{var n=await this.fetch(e,{method:"POST",body:JSON.stringify(t),headers:{...o,...s}})}catch{return[{error:re},500]}let r,i;try{r=await n.json(),i=n.status}catch(a){r={error:`Could not parse server response: ${a}`},i=500}return[r,i]}async function Yt(e,t){let s=!1,o=!1,n;if(!this.config)throw new Error("Could not resolve app config");if(typeof e=="number")n=this.config.dependencies[e];else{const r=e.replace(/^\//,"");n=this.config.dependencies[this.api_map[r]]}if(n?.types.continuous)throw new Error("Cannot call predict on this function as it may run forever. Use submit instead");return new Promise(async(r,i)=>{const a=this.submit(e,t);let f;a.on("data",m=>{o&&(a.destroy(),r(m)),s=!0,f=m}).on("status",m=>{m.stage==="error"&&i(m),m.stage==="complete"&&(o=!0,s&&(a.destroy(),r(f)))})})}async function qe(e,t,s){let o=t==="subdomain"?`https://huggingface.co/api/spaces/by-subdomain/${e}`:`https://huggingface.co/api/spaces/${e}`,n,r;try{if(n=await fetch(o),r=n.status,r!==200)throw new Error;n=await n.json()}catch{s({status:"error",load_status:"error",message:Nt,detail:"NOT_FOUND"});return}if(!n||r!==200)return;const{runtime:{stage:i},id:a}=n;switch(i){case"STOPPED":case"SLEEPING":s({status:"sleeping",load_status:"pending",message:"Space is asleep. Waking it up...",detail:i}),setTimeout(()=>{qe(e,t,s)},1e3);break;case"PAUSED":s({status:"paused",load_status:"error",message:"This space has been paused by the author. If you would like to try this demo, consider duplicating the space.",detail:i,discussions_enabled:await He(a)});break;case"RUNNING":case"RUNNING_BUILDING":s({status:"running",load_status:"complete",message:"",detail:i});break;case"BUILDING":s({status:"building",load_status:"pending",message:"Space is building...",detail:i}),setTimeout(()=>{qe(e,t,s)},1e3);break;default:s({status:"space_error",load_status:"error",message:"This space is experiencing an issue.",detail:i,discussions_enabled:await He(a)});break}}const Zt=/^(?=[^]*\b[dD]iscussions{0,1}\b)(?=[^]*\b[dD]isabled\b)[^]*$/;async function He(e){try{const s=(await fetch(`https://huggingface.co/api/spaces/${e}/discussions`,{method:"HEAD"})).headers.get("x-error-message");return!(s&&Zt.test(s))}catch{return!1}}async function Xt(e,t){const s={};t&&(s.Authorization=`Bearer ${t}`);try{const o=await fetch(`https://huggingface.co/api/spaces/${e}/${Tt}`,{headers:s});if(o.status!==200)throw new Error("Space hardware could not be obtained.");const{hardware:n}=await o.json();return n.current}catch(o){throw new Error(o.message)}}async function xt(e,t,s){const o={};s&&(o.Authorization=`Bearer ${s}`);const n={seconds:t};try{const r=await fetch(`https://huggingface.co/api/spaces/${e}/${At}`,{method:"POST",headers:{"Content-Type":"application/json",...o},body:JSON.stringify(n)});if(r.status!==200)throw new Error("Could not set sleep timeout on duplicated Space. Please visit *ADD HF LINK TO SETTINGS* to set a timeout manually to reduce billing charges.");return await r.json()}catch(r){throw new Error(r.message)}}const Je=["cpu-basic","cpu-upgrade","cpu-xl","t4-small","t4-medium","a10g-small","a10g-large","a10g-largex2","a10g-largex4","a100-large","zero-a10g","h100","h100x8"];async function es(e,t){const{hf_token:s,private:o,hardware:n,timeout:r}=t;if(n&&!Je.includes(n))throw new Error(`Invalid hardware type provided. Valid types are: ${Je.map(u=>`"${u}"`).join(",")}.`);const i={Authorization:`Bearer ${s}`,"Content-Type":"application/json"},a=(await(await fetch("https://huggingface.co/api/whoami-v2",{headers:i})).json()).name,f=e.split("/")[1],m={repository:`${a}/${f}`};o&&(m.private=!0);let d;try{n||(d=await Xt(e,s))}catch(u){throw Error(Bt+u.message)}const _=n||d||"cpu-basic";m.hardware=_;try{const u=await fetch(`https://huggingface.co/api/spaces/${e}/duplicate`,{method:"POST",headers:i,body:JSON.stringify(m)});if(u.status===409)try{return await Ge.connect(`${a}/${f}`,t)}catch(B){throw console.error("Failed to connect Client instance:",B),B}else if(u.status!==200)throw new Error(u.statusText);const v=await u.json();return await xt(`${a}/${f}`,r||300,s),await Ge.connect(ts(v.url),t)}catch(u){throw new Error(u)}}function ts(e){const t=/https:\/\/huggingface.co\/spaces\/([^/]+\/[^/]+)/,s=e.match(t);if(s)return s[1]}async function ss(){let{event_callbacks:e,unclosed_events:t,pending_stream_messages:s,stream_status:o,config:n,jwt:r}=this;if(!n)throw new Error("Could not resolve app config");o.open=!0;let i=null,a=new URLSearchParams({session_hash:this.session_hash}).toString(),f=new URL(`${n.root}/queue/data?${a}`);if(r&&f.searchParams.set("__sign",r),i=await this.stream(f),!i){console.warn("Cannot connect to SSE endpoint: "+f.toString());return}i.onmessage=async function(m){let d=JSON.parse(m.data);if(d.msg==="close_stream"){fe(o,i);return}const _=d.event_id;if(!_)await Promise.all(Object.keys(e).map(u=>e[u](d)));else if(e[_]&&n){d.msg==="process_completed"&&["sse","sse_v1","sse_v2","sse_v2.1"].includes(n.protocol)&&(t.delete(_),t.size===0&&fe(o,i));let u=e[_];typeof window<"u"?window.setTimeout(u,0,d):setImmediate(u,d)}else s[_]||(s[_]=[]),s[_].push(d)},i.onerror=async function(){await Promise.all(Object.keys(e).map(m=>e[m]({msg:"unexpected_error",message:re}))),fe(o,i)}}function fe(e,t){e&&t&&(e.open=!1,t?.close())}function ns(e,t,s){!e[t]?(e[t]=[],s.data.forEach((n,r)=>{e[t][r]=n})):s.data.forEach((n,r)=>{let i=os(e[t][r],n);e[t][r]=i,s.data[r]=i})}function os(e,t){return t.forEach(([s,o,n])=>{e=is(e,o,s,n)}),e}function is(e,t,s,o){if(t.length===0){if(s==="replace")return o;if(s==="append")return e+o;throw new Error(`Unsupported action: ${s}`)}let n=e;for(let i=0;i<t.length-1;i++)n=n[t[i]];const r=t[t.length-1];switch(s){case"replace":n[r]=o;break;case"append":n[r]+=o;break;case"add":Array.isArray(n)?n.splice(Number(r),0,o):n[r]=o;break;case"delete":Array.isArray(n)?n.splice(Number(r),1):delete n[r];break;default:throw new Error(`Unknown action: ${s}`)}return e}function rs(e,t,s,o){try{let n=function(P){const G=A[P.type]||[];G?.forEach(S=>S(P))},r=function(P,q){const G=A,S=G[P]||[];return G[P]=S,S?.push(q),{on:r,off:i,cancel:Oe,destroy:a}},i=function(P,q){const G=A;let S=G[P]||[];return S=S?.filter(X=>X!==q),G[P]=S,{on:r,off:i,cancel:Oe,destroy:a}},a=function(){var P;for(const q in A)A&&((P=A[q])==null||P.forEach(G=>{i(q,G)}))};const{hf_token:f}=this.options,{fetch:m,app_reference:d,config:_,session_hash:u,api_info:v,api_map:B,stream_status:O,pending_stream_messages:D,pending_diff_streams:L,event_callbacks:g,unclosed_events:Y,post_data:te}=this;if(!v)throw new Error("No API found");if(!_)throw new Error("Could not resolve app config");let{fn_index:w,endpoint_info:Se,dependency:Ie}=as(v,e,B,_),me=Wt(t,v),U,F,J=_.protocol??"ws";const k=typeof e=="number"?"/predict":e;let $,I=null,h=!1;const A={};let De={},ie=typeof window<"u"?new URLSearchParams(window.location.search).toString():"";async function Oe(){const P={stage:"complete",queue:!1,time:new Date};h=P,n({...P,type:"status",endpoint:k,fn_index:w});let q={};J==="ws"?(U&&U.readyState===0?U.addEventListener("open",()=>{U.close()}):U.close(),q={fn_index:w,session_hash:u}):(F?.close(),q={event_id:I});try{if(!_)throw new Error("Could not resolve app config");await m(`${_.root}/reset`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(q)})}catch{console.warn("The `/reset` endpoint could not be called. Subsequent endpoint results may be unreliable.")}}return this.handle_blob(_.root,me,Se).then(async P=>{var q;if($={data:P||[],event_data:s,fn_index:w,trigger_id:o},Ht(w,_))n({type:"status",endpoint:k,stage:"pending",queue:!1,fn_index:w,time:new Date}),te(`${_.root}/run${k.startsWith("/")?k:`/${k}`}${ie?"?"+ie:""}`,{...$,session_hash:u}).then(([S,X])=>{const x=S.data;X==200?(n({type:"data",endpoint:k,fn_index:w,data:x,time:new Date,event_data:s,trigger_id:o}),n({type:"status",endpoint:k,fn_index:w,stage:"complete",eta:S.average_duration,queue:!1,time:new Date})):n({type:"status",stage:"error",endpoint:k,fn_index:w,message:S.error,queue:!1,time:new Date})}).catch(S=>{n({type:"status",stage:"error",message:S.message,endpoint:k,fn_index:w,queue:!1,time:new Date})});else if(J=="ws"){const{ws_protocol:S,host:X}=await st(d,f);n({type:"status",stage:"pending",queue:!0,endpoint:k,fn_index:w,time:new Date});let x=new URL(`${S}://${et(X,_.path,!0)}/queue/join${ie?"?"+ie:""}`);this.jwt&&x.searchParams.set("__sign",this.jwt),U=new WebSocket(x),U.onclose=Z=>{Z.wasClean||n({type:"status",stage:"error",broken:!0,message:re,queue:!0,endpoint:k,fn_index:w,time:new Date})},U.onmessage=function(Z){const V=JSON.parse(Z.data),{type:j,status:z,data:ee}=Le(V,De[w]);if(j==="update"&&z&&!h)n({type:"status",endpoint:k,fn_index:w,time:new Date,...z}),z.stage==="error"&&U.close();else if(j==="hash"){U.send(JSON.stringify({fn_index:w,session_hash:u}));return}else j==="data"?U.send(JSON.stringify({...$,session_hash:u})):j==="complete"?h=z:j==="log"?n({type:"log",log:ee.log,level:ee.level,endpoint:k,fn_index:w}):j==="generating"&&n({type:"status",time:new Date,...z,stage:z?.stage,queue:!0,endpoint:k,fn_index:w});ee&&(n({type:"data",time:new Date,data:ee.data,endpoint:k,fn_index:w,event_data:s,trigger_id:o}),h&&(n({type:"status",time:new Date,...h,stage:z?.stage,queue:!0,endpoint:k,fn_index:w}),U.close()))},Xe(_.version||"2.0.0","3.6")<0&&addEventListener("open",()=>U.send(JSON.stringify({hash:u})))}else if(J=="sse"){n({type:"status",stage:"pending",queue:!0,endpoint:k,fn_index:w,time:new Date});var G=new URLSearchParams({fn_index:w.toString(),session_hash:u}).toString();let S=new URL(`${_.root}/queue/join?${ie?ie+"&":""}${G}`);if(this.jwt&&S.searchParams.set("__sign",this.jwt),F=await this.stream(S),!F)return Promise.reject(new Error("Cannot connect to SSE endpoint: "+S.toString()));F.onmessage=async function(X){const x=JSON.parse(X.data),{type:Z,status:V,data:j}=Le(x,De[w]);if(Z==="update"&&V&&!h)n({type:"status",endpoint:k,fn_index:w,time:new Date,...V}),V.stage==="error"&&F?.close();else if(Z==="data"){I=x.event_id;let[z,ee]=await te(`${_.root}/queue/data`,{...$,session_hash:u,event_id:I});ee!==200&&(n({type:"status",stage:"error",message:re,queue:!0,endpoint:k,fn_index:w,time:new Date}),F?.close())}else Z==="complete"?h=V:Z==="log"?n({type:"log",log:j.log,level:j.level,endpoint:k,fn_index:w}):Z==="generating"&&n({type:"status",time:new Date,...V,stage:V?.stage,queue:!0,endpoint:k,fn_index:w});j&&(n({type:"data",time:new Date,data:j.data,endpoint:k,fn_index:w,event_data:s,trigger_id:o}),h&&(n({type:"status",time:new Date,...h,stage:V?.stage,queue:!0,endpoint:k,fn_index:w}),F?.close()))}}else if(J=="sse_v1"||J=="sse_v2"||J=="sse_v2.1"||J=="sse_v3"){n({type:"status",stage:"pending",queue:!0,endpoint:k,fn_index:w,time:new Date});let S="";typeof window<"u"&&(S=(q=window?.location)==null?void 0:q.hostname);let X="dev.spaces.huggingface.tech";const x=S.includes(".dev.")?`https://moon-${S.split(".")[1]}.${X}`:"https://huggingface.co";(Ie.zerogpu&&window.parent!=window&&_.space_id?Jt("zerogpu-headers",x):Promise.resolve(null)).then(j=>te(`${_.root}/queue/join?${ie}`,{...$,session_hash:u},j)).then(async([j,z])=>{if(z===503)n({type:"status",stage:"error",message:xe,queue:!0,endpoint:k,fn_index:w,time:new Date});else if(z!==200)n({type:"status",stage:"error",message:re,queue:!0,endpoint:k,fn_index:w,time:new Date});else{I=j.event_id;let ee=async function(Te){try{const{type:se,status:M,data:ne}=Le(Te,De[w]);if(se=="heartbeat")return;if(se==="update"&&M&&!h)n({type:"status",endpoint:k,fn_index:w,time:new Date,...M});else if(se==="complete")h=M;else if(se=="unexpected_error")console.error("Unexpected error",M?.message),n({type:"status",stage:"error",message:M?.message||"An Unexpected Error Occurred!",queue:!0,endpoint:k,fn_index:w,time:new Date});else if(se==="log"){n({type:"log",log:ne.log,level:ne.level,endpoint:k,fn_index:w});return}else se==="generating"&&(n({type:"status",time:new Date,...M,stage:M?.stage,queue:!0,endpoint:k,fn_index:w}),ne&&["sse_v2","sse_v2.1","sse_v3"].includes(J)&&ns(L,I,ne));ne&&(n({type:"data",time:new Date,data:ne.data,endpoint:k,fn_index:w}),ne.render_config&&n({type:"render",data:ne.render_config,endpoint:k,fn_index:w}),h&&n({type:"status",time:new Date,...h,stage:M?.stage,queue:!0,endpoint:k,fn_index:w})),(M?.stage==="complete"||M?.stage==="error")&&(g[I]&&delete g[I],I in L&&delete L[I])}catch(se){console.error("Unexpected client exception",se),n({type:"status",stage:"error",message:"An Unexpected Error Occurred!",queue:!0,endpoint:k,fn_index:w,time:new Date}),["sse_v2","sse_v2.1"].includes(J)&&(fe(O,F),O.open=!1)}};I in D&&(D[I].forEach(Te=>ee(Te)),delete D[I]),g[I]=ee,Y.add(I),O.open||await this.open_stream()}})}}),{on:r,off:i,cancel:Oe,destroy:a}}catch(n){throw console.error("Submit function encountered an error:",n),n}}function as(e,t,s,o){let n,r,i;if(typeof t=="number")n=t,r=e.unnamed_endpoints[n],i=o.dependencies[t];else{const a=t.replace(/^\//,"");n=s[a],r=e.named_endpoints[t.trim()],i=o.dependencies[s[a]]}if(typeof n!="number")throw new Error("There is no endpoint matching that name of fn_index matching that number.");return{fn_index:n,endpoint_info:r,dependency:i}}class We extends Blob{constructor(t,s){super(t,s)}}class Ge{constructor(t,s={}){E(this,"app_reference"),E(this,"options"),E(this,"config"),E(this,"api_info"),E(this,"api_map",{}),E(this,"session_hash",Math.random().toString(36).substring(2)),E(this,"jwt",!1),E(this,"last_status",{}),E(this,"stream_status",{open:!1}),E(this,"pending_stream_messages",{}),E(this,"pending_diff_streams",{}),E(this,"event_callbacks",{}),E(this,"unclosed_events",new Set),E(this,"heartbeat_event",null),E(this,"view_api"),E(this,"upload_files"),E(this,"upload"),E(this,"handle_blob"),E(this,"post_data"),E(this,"submit"),E(this,"predict"),E(this,"open_stream"),E(this,"resolve_config"),this.app_reference=t,this.options=s,this.view_api=Gt.bind(this),this.upload_files=zt.bind(this),this.handle_blob=Kt.bind(this),this.post_data=Qt.bind(this),this.submit=rs.bind(this),this.predict=Yt.bind(this),this.open_stream=ss.bind(this),this.resolve_config=Mt.bind(this),this.upload=Vt.bind(this)}fetch(t,s){return fetch(t,s)}async stream(t){if(typeof window>"u"||typeof EventSource>"u")try{const s=await H(()=>import("./eventsource.4deb033a.js").then(function(o){return o.e}),["assets/eventsource.4deb033a.js","assets/__vite-browser-external.afb582f8.js","assets/_commonjsHelpers.294d03c4.js"]);return new s.default(t.toString())}catch(s){throw console.error("Failed to load EventSource module:",s),s}else return new EventSource(t.toString())}async init(){var t;if((typeof window>"u"||!("WebSocket"in window))&&!global.WebSocket){const s=await H(()=>import("./wrapper-CviSselG.60495582.js"),["assets/wrapper-CviSselG.60495582.js","assets/__vite-browser-external.afb582f8.js"]);We=(await H(()=>import("./__vite-browser-external.afb582f8.js").then(function(o){return o._}),[])).Blob,global.WebSocket=s.WebSocket}try{await this._resolve_config().then(async({config:s})=>{if(this.config=s,s.space_id&&this.options.hf_token&&(this.jwt=await Lt(s.space_id,this.options.hf_token)),this.config&&this.config.connect_heartbeat){const o=new URL(`${this.config.root}/heartbeat/${this.session_hash}`);this.jwt&&o.searchParams.set("__sign",this.jwt),this.heartbeat_event=await this.stream(o)}})}catch(s){throw Error(ue+s.message)}this.api_info=await this.view_api(),this.api_map=Pt(((t=this.config)==null?void 0:t.dependencies)||[])}static async connect(t,s={}){const o=new this(t,s);return await o.init(),o}close(){var t;(t=this.heartbeat_event)==null||t.close()}static async duplicate(t,s={}){return es(t,s)}async _resolve_config(){const{http_protocol:t,host:s,space_id:o}=await st(this.app_reference,this.options.hf_token),{status_callback:n}=this.options;let r;try{if(r=await this.resolve_config(`${t}//${s}`),!r)throw new Error(ue);return this.config_success(r)}catch(i){console.error(i),o?qe(o,tt.test(o)?"space_name":"subdomain",this.handle_space_success):n&&n({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"})}}async config_success(t){if(this.config=t,typeof window<"u"&&window.location.protocol==="https:"&&(this.config.root=this.config.root.replace("http://","https://")),this.config.auth_required)return this.prepare_return_obj();try{this.api_info=await this.view_api()}catch(s){console.error(Ct+s.message)}return this.prepare_return_obj()}async handle_space_success(t){const{status_callback:s}=this.options;if(s&&s(t),t.status==="running")try{if(this.config=await this._resolve_config(),!this.config)throw new Error(ue);return await this.config_success(this.config)}catch(o){console.error(o),s&&s({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"})}}async component_server(t,s,o){var n;if(!this.config)throw new Error(ue);const r={},{hf_token:i}=this.options,{session_hash:a}=this;i&&(r.Authorization=`Bearer ${this.options.hf_token}`);let f,m=this.config.components.find(_=>_.id===t);(n=m?.props)!=null&&n.root_url?f=m.props.root_url:f=this.config.root;let d;if("binary"in o){d=new FormData;for(const _ in o.data)_!=="binary"&&d.append(_,o.data[_]);d.set("component_id",t.toString()),d.set("fn_name",s),d.set("session_hash",a)}else d=JSON.stringify({data:o,component_id:t,fn_name:s,session_hash:a}),r["Content-Type"]="application/json";i&&(r.Authorization=`Bearer ${i}`);try{const _=await this.fetch(`${f}/component_server/`,{method:"POST",body:d,headers:r});if(!_.ok)throw new Error("Could not connect to component server: "+_.statusText);return await _.json()}catch(_){console.warn(_)}}prepare_return_obj(){return{config:this.config,predict:this.predict,submit:this.submit,view_api:this.view_api,component_server:this.component_server}}}const ke=N.BUILD_ENABLE_CHATBOT_DUMMY_DATA_MODE,$e=window.location.origin,Ke=N.BUILD_CHATBOT_API_DOMAIN_STAGING;let ot;const cs=async()=>{console.log("connect to : ",Ke),ot=await Ge.connect(Ke)},be=async(e,t)=>(await ot.predict(e,t)).data[0],ls=async()=>ke?await he.get(`${$e}/dummyData/bookcase/bookcaseDocumentsListSample.json`):await be("/get_temp_group",[]),us=async e=>ke?await he.get(`${$e}/dummyData/bookcase/bookcaseAddNewBookcaseSample.json`):await be("/new_group",[e]),ds=async e=>ke?await he.get(`${$e}/dummyData/bookcase/bookcaseDeleteDocumentSample.json`):await be("/delete_temp_group",[e]),_s=async e=>ke?await he.get(`${$e}/dummyData/bookcase/bookcaseAddTempBookcaseSample.json`):await be("/add_temp_group",[e]);var de={initAppClient:cs,getTempBookcaseDocumentsList:ls,addNewBookcase:us,deleteTempBookcaseDocument:ds,addTempBookcase:_s};const Ee=e=>(ye("data-v-6fcd9c68"),e=e(),we(),e),ps={key:0,class:"common-book-list-add-btn__book-list"},ms={class:"list-head flex justify-between"},fs={class:"list-head__title"},hs=Ee(()=>l("img",{src:"/images/icons/close.svg",alt:""},null,-1)),gs=[hs],ys={class:"list-content customized-scrollbar"},ws={class:"document-info column justify-between"},vs={class:"document-info__title cursor-pointer"},ks={class:"document-info__origin"},$s={class:"date"},bs={class:"document-info__committee"},Es=["onClick"],Ss=Ee(()=>l("img",{src:"/images/icons/delete.svg",alt:""},null,-1)),Is=[Ss],Ds=Ee(()=>l("img",{src:"/images/icons/add_bookcase.svg",alt:""},null,-1)),Os=Ee(()=>l("img",{src:"/images/icons/document_icon.svg",alt:""},null,-1)),Ts=[Os],As=K({__name:"CommonBookListBtn",setup(e){const t=at(),s=T(!1),o=m=>{s.value=m},n=T(),r=m=>{wt.confirm({title:`\u522A\u9664\u6587\u4EF6(${m.name})\uFF1F`,message:"\u522A\u9664\u5F8C\u7121\u6CD5\u5FA9\u539F\u3002",onOk:async()=>{(await de.deleteTempBookcaseDocument(m.data_key)).result.success&&Fe.error("\u5DF2\u522A\u9664"),await f()}})},i=T(!1),a=async m=>{i.value=!1;const d={title:m,documents_list:n.value.map(u=>u.data_key)},_=await de.addNewBookcase(d.title);Fe.success(`\u5EFA\u7ACB\u6210\u529F: ${_.result.title}`),t.push({name:"BookcaseListPage"})},f=async()=>{const m=await de.getTempBookcaseDocumentsList();n.value=m.result};return ge(async()=>{await de.initAppClient(),await f()}),(m,d)=>{const _=yt;return c(),p(C,null,[l("div",{class:oe(["common-book-list-add-btn center-img",{active:s.value}])},[s.value?(c(),p("div",ps,[l("div",{class:"mask",onClick:d[0]||(d[0]=u=>o(!1))}),l("div",ms,[l("div",fs,y(m.$t("$i18n_list_$i18n")),1),l("div",{class:"list-head__close cursor-pointer",onClick:d[1]||(d[1]=u=>o(!1))},gs)]),l("div",ys,[(c(!0),p(C,null,W(n.value,u=>(c(),p("div",{class:"document flex justify-between items-center",key:u.data_key},[l("div",ws,[l("div",vs,y(u.name),1),l("div",ks,[ae(" ["+y(m.$t("$i18n_source_$i18n"))+y(u.origin)+"] \u2014 ",1),l("span",$s,y(u.date),1)]),l("div",bs,y(m.$t("$i18n_conferenceName_$i18n"))+"\uFF1A"+y(u.conference),1)]),l("div",{class:"document-delete cursor-pointer",onClick:v=>r(u)},Is,8,Es)]))),128))]),l("div",{class:"list-btn",onClick:d[2]||(d[2]=u=>i.value=!i.value)},[Ds,l("span",null,y(m.$t("$i18n_createBookcase_$i18n")),1)])])):b("",!0),l("div",{class:"common-book-list-add-btn__icon cursor-pointer",onClick:d[3]||(d[3]=u=>o(!0))},Ts)],2),pe(_,{modelValue:i.value,"onUpdate:modelValue":d[4]||(d[4]=u=>i.value=u),onSubmitInput:a,title:"\u66F8\u6AC3\u540D\u7A31",placeholder:"\u8ACB\u8F38\u5165\u66F8\u6AC3\u540D\u7A31"},null,8,["modelValue"])],64)}}});var Rs=Q(As,[["__scopeId","data-v-6fcd9c68"]]);function Ns(e){switch(e){case"../../../src/services/deprecated/DeprecatedSystemServices.ts":return H(()=>import("./DeprecatedSystemServices.c0d09c1c.js"),["assets/DeprecatedSystemServices.c0d09c1c.js","assets/index.5760d8ee.js","assets/index.4f99bc31.css"]);case"../../../src/services/Offline/OfflineSystemServices.ts":return H(()=>import("./OfflineSystemServices.1eb6b446.js"),["assets/OfflineSystemServices.1eb6b446.js","assets/index.5760d8ee.js","assets/index.4f99bc31.css"]);case"../../../src/services/Online/OnlineSystemServices.ts":return H(()=>import("./OnlineSystemServices.ed285198.js"),["assets/OnlineSystemServices.ed285198.js","assets/index.5760d8ee.js","assets/index.4f99bc31.css"]);default:return new Promise(function(t,s){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+e)))})}}let Pe=N.BUILD_OFFLINE_MODE?"Offline":"Online";const Qe=Pe==="Online"?await Ns(`../../../src/services/${Pe}/${Pe}SystemServices.ts`):"",Cs=K({name:"SystemDrawer",props:{isShowDrawer:{type:Boolean,default:!1},devices:{type:Array,required:!0}},emits:["toggleDrawer"],setup(e,{emit:t}){const s=T(),o=T(!1),r=Ye().params.id.toString(),i=()=>{t("toggleDrawer")},a=d=>{const _=e.devices.find(u=>u.deviceId===d);_&&(_.editingSystem=!_.editingSystem)};return{searchType:s,val:o,componentId:r,toggleDrawer:i,createSystem:async d=>{const _=e.devices.find(u=>u.deviceId===d);if(_&&_.editingInput){const u=await Qe.postSystems({deviceId:d,systemName:_.editingInput.toString()});_.systems.push({systemName:u.result.systemName,systemId:u.result.systemId,components:[],selected:!1,reports:[],reportStatus:"idle"}),_.editingInput=""}a(d)},addToSystem:async d=>{const _=[];e.devices.forEach(u=>{u.systems.forEach(v=>{v.selected&&_.push({systemId:v.systemId})})}),await Qe.postComponents(d,{systems:[..._]}),ct.create({message:"\u52A0\u5165\u6210\u529F!",color:"primary",position:"top",timeout:2e3}),t("toggleDrawer")},toggleEdit:a}}}),ze=e=>(ye("data-v-4b751936"),e=e(),we(),e),Bs={key:0,class:"system-drawer"},Ls={class:"drawer flex column justify-between"},Ps={class:"drawer__header flex justify-between"},Ms=ze(()=>l("div",null,null,-1)),Us=ze(()=>l("img",{src:"/images/icons/close.svg",alt:""},null,-1)),Fs=[Us],js={class:"drawer__content"},qs={class:"systems flex column"},Ws={class:""},Gs=["onClick"],zs=ze(()=>l("img",{src:"/images/icons/addNumber.svg",alt:""},null,-1)),Vs={key:1,class:"editing-system flex items-center"},Hs=["onClick"],Js=["onClick"];function Ks(e,t,s,o,n,r){return e.isShowDrawer?(c(),p("div",Bs,[l("div",{class:"mask",onClick:t[0]||(t[0]=(...i)=>e.toggleDrawer&&e.toggleDrawer(...i)),onScroll:t[1]||(t[1]=lt(()=>{},["prevent"]))},null,32),l("div",Ls,[l("div",Ps,[Ms,l("div",null,y(e.$t("$i18n_addToSystemsList_$i18n")),1),l("div",{class:"close cursor-pointer",onClick:t[2]||(t[2]=(...i)=>e.toggleDrawer&&e.toggleDrawer(...i))},Fs)]),l("div",js,[(c(!0),p(C,null,W(e.devices,i=>(c(),R(Ze,{label:i.deviceName,class:"device",key:i.deviceId},{default:ce(()=>[l("div",qs,[(c(!0),p(C,null,W(i.systems,a=>(c(),p("div",{class:"system flex justify-between items-center",key:a.systemId},[l("div",Ws,y(a.systemName),1),pe(ut,{modelValue:a.selected,"onUpdate:modelValue":f=>a.selected=f,color:"black"},null,8,["modelValue","onUpdate:modelValue"])]))),128))]),i.editingSystem?b("",!0):(c(),p("div",{key:0,class:"add-system flex",onClick:a=>e.toggleEdit(i.deviceId)},[zs,l("div",null,y(e.$t("$i18n_addSystem_$i18n")),1)],8,Gs)),i.editingSystem?(c(),p("div",Vs,[pe(dt,{borderless:"",modelValue:i.editingInput,"onUpdate:modelValue":a=>i.editingInput=a,placeholder:e.$t("$i18n_enterSystemName_$i18n")},null,8,["modelValue","onUpdate:modelValue","placeholder"]),l("div",{class:"create cursor-pointer",onClick:a=>e.createSystem(i.deviceId)},y(e.$t("$i18n_create_$i18n")),9,Hs),l("div",{class:"cancel cursor-pointer",onClick:a=>e.toggleEdit(i.deviceId)},y(e.$t("$i18n_cancel_$i18n")),9,Js)])):b("",!0)]),_:2},1032,["label"]))),128))]),l("div",{class:"drawer__submit cursor-pointer",onClick:t[3]||(t[3]=i=>e.addToSystem(e.componentId))},y(e.$t("$i18n_submit_$i18n")),1)])])):b("",!0)}var Qs=Q(Cs,[["render",Ks],["__scopeId","data-v-4b751936"]]);const Ys=K({name:"ReportBlock",props:{reports:{type:Array,required:!0},limited:{type:Boolean,default:!1}},setup(){return{store:le(),config:N}}}),Zs=e=>(ye("data-v-7cf18d1a"),e=e(),we(),e),Xs={id:"report-block",class:"report-block"},xs={class:"report__list"},en=Zs(()=>l("div",{class:"report-img"},[l("img",{src:"/images/icons/report.png",alt:""})],-1)),tn={key:0,class:"report wiki__limited"},sn={key:0,class:"text-red-7"};function nn(e,t,s,o,n,r){return c(),p("div",Xs,[l("div",xs,[(c(!0),p(C,null,W(e.reports,i=>(c(),p("div",{class:"report",key:i.report_key},[pe(Ze,{label:`${i.name}`,caption:"2024-01-16"},{default:ce(()=>[en]),_:2},1032,["label"])]))),128)),e.limited?(c(),p("div",tn,[e.store.RUNTIME_SHOW_API_ERROR_MESSAGE?(c(),p("span",sn,y(e.config.RUNTIME_API_ERROR_MESSAGE),1)):b("",!0)])):b("",!0)])])}var on=Q(Ys,[["render",nn],["__scopeId","data-v-7cf18d1a"]]);const rn=K({name:"DocumentCard",props:{document:{type:Object,required:!0}},setup(){return{}}}),an={class:"document-title"},cn={class:"conference-name"},ln={class:"document-source"},un={class:"date"};function dn(e,t,s,o,n,r){const i=ve("router-link");return c(),R(i,{to:`/${e.$i18n.locale}/document/${e.document.data_key}`,class:"related-document-card cursor-pointer"},{default:ce(()=>[l("div",an,[ae(y(e.document.file)+" ",1),l("div",cn,y(e.$t("$i18n_conferenceName_$i18n"))+"\uFF1A"+y(e.document.conference),1)]),l("div",ln,[l("span",un,y(e.document.date),1)])]),_:1},8,["to"])}var it=Q(rn,[["render",dn]]);const _n=K({name:"RelatedDocBlock",props:{title:{type:String,required:!0},documents:{type:Array,required:!1},limited:{type:Boolean,default:!1}},components:{DocumentLink:it},emits:["goPage"],setup(e,{emit:t}){return{store:le(),config:N,getPageResult:async n=>{t("goPage",n)}}}}),pn={id:"doc-block",class:"doc-block"},mn={class:"block__title"},fn={key:0,class:"wiki__limited text-red-7"};function hn(e,t,s,o,n,r){const i=it;return c(),p("div",pn,[l("div",mn,y(e.$t(e.title)),1),e.limited&&e.store.RUNTIME_SHOW_API_ERROR_MESSAGE?(c(),p("span",fn,y(e.config.RUNTIME_API_ERROR_MESSAGE),1)):b("",!0),(c(!0),p(C,null,W(e.documents,a=>(c(),R(i,{key:a.conference,document:a},null,8,["document"]))),128))])}var gn=Q(_n,[["render",hn]]);const yn=K({name:"IssueWiki",props:{title:{type:String,required:!0},issues:{type:Array,required:!1},limited:{type:Boolean,default:!1}},setup(){const e=le(),t=T(!0),s=T(),o=()=>{s.value.clientHeight>68&&(t.value=!1)},n=()=>{t.value=!0};return ge(async()=>{o()}),{store:e,tagsWrapper:s,isShowAllTags:t,config:N,showAllTags:n}}}),wn={id:"issues-tag-block",class:"issues-tag-block"},vn={class:"tags__title"},kn={class:"tags__block issue__tags__block"},$n={key:0,class:"text-red-7"};function bn(e,t,s,o,n,r){const i=ve("router-link");return c(),p("div",wn,[l("div",vn,y(e.$t(e.title)),1),l("div",kn,[l("div",{class:oe(["tags__wrapper issue__tags__wrapper",{fixedHeight:!e.isShowAllTags}]),ref:"tagsWrapper"},[e.limited&&e.store.RUNTIME_SHOW_API_ERROR_MESSAGE?(c(),p("span",$n,y(e.config.RUNTIME_API_ERROR_MESSAGE),1)):b("",!0),(c(!0),p(C,null,W(e.issues,a=>(c(),R(i,{class:"tag",key:a.name,to:a.data_key?`/${e.$i18n.locale}/issue/${a.data_key}`:""},{default:ce(()=>[ae(y(a.name),1)]),_:2},1032,["to"]))),128))],2),e.isShowAllTags?b("",!0):(c(),p("div",{key:0,class:"tag tag__more",onClick:t[0]||(t[0]=(...a)=>e.showAllTags&&e.showAllTags(...a))}," ... "))])])}var En=Q(yn,[["render",bn]]);const Sn=K({name:"RelatedComponentBlock",props:{title:{type:String,required:!0},components:{type:Array,required:!1},limited:{type:Boolean,default:!1}},setup(){const e=le(),t=T(!0),s=T(),o=()=>{s.value.clientHeight>68&&(t.value=!1)},n=()=>{t.value=!0};return ge(async()=>{o()}),{store:e,tagsWrapper:s,isShowAllTags:t,config:N,showAllTags:n}}}),In={id:"components-tag-block",class:"components-tag-block"},Dn={class:"tags__title"},On={class:"tags__block component__tags__block"},Tn={key:0,class:"text-red-7"};function An(e,t,s,o,n,r){const i=ve("router-link");return c(),p("div",In,[l("div",Dn,y(e.$t(e.title)),1),l("div",On,[l("div",{class:oe(["tags__wrapper component__tags__wrapper",{fixedHeight:!e.isShowAllTags}]),ref:"tagsWrapper"},[e.limited&&e.store.RUNTIME_SHOW_API_ERROR_MESSAGE?(c(),p("span",Tn,y(e.config.RUNTIME_API_ERROR_MESSAGE),1)):b("",!0),(c(!0),p(C,null,W(e.components,a=>(c(),R(i,{class:"tag",key:a.name,to:a.data_key?`/${e.$i18n.locale}/component/${a.data_key}`:""},{default:ce(()=>[ae(y(a.name),1)]),_:2},1032,["to"]))),128))],2),e.isShowAllTags?b("",!0):(c(),p("div",{key:0,class:"tag tag__more",onClick:t[0]||(t[0]=(...a)=>e.showAllTags&&e.showAllTags(...a))}," ... "))])])}var Rn=Q(Sn,[["render",An]]);const Nn=K({name:"DocumentsLinks",props:{title:{type:String,required:!0},attachments:{type:Array,required:!1},links:{type:Array,required:!1},limited:{type:Boolean,default:!1},type:{type:String,required:!0}},components:{},setup(){const e=le();return{config:N,store:e}}}),Cn={key:0,id:"documents-links",class:"documents-links"},Bn={class:"block__title"},Ln={class:"block__documents"},Pn={key:0,class:"wiki_limited text-red-7"},Mn={class:"title"},Un=["href"],Fn=l("span",{class:"material-symbols-outlined"},"description",-1),jn={key:1,id:"documents-links",class:"documents-links"},qn={class:"block__title"},Wn={class:"block__links"},Gn={key:0,class:"wiki_limited text-red-7"},zn={class:"title"},Vn=["href"],Hn=l("span",{class:"material-symbols-outlined"},"link",-1);function Jn(e,t,s,o,n,r){return c(),p(C,null,[e.type==="attachments"?(c(),p("div",Cn,[l("div",Bn,y(e.$t(e.title)),1),l("div",Ln,[e.limited&&e.store.RUNTIME_SHOW_API_ERROR_MESSAGE?(c(),p("span",Pn,y(e.config.RUNTIME_API_ERROR_MESSAGE),1)):b("",!0),(c(!0),p(C,null,W(e.attachments,i=>(c(),p("div",{class:"block__documents__document",key:i.name},[l("div",Mn,y(i.name),1),l("a",{href:i.url,target:"_blank",class:"link"},[ae(y(e.$t(i.title))+" ",1),Fn],8,Un)]))),128))])])):b("",!0),e.type==="links"?(c(),p("div",jn,[l("div",qn,y(e.$t(e.title)),1),l("div",Wn,[e.limited&&e.store.RUNTIME_SHOW_API_ERROR_MESSAGE?(c(),p("span",Gn,y(e.config.RUNTIME_API_ERROR_MESSAGE),1)):b("",!0),(c(!0),p(C,null,W(e.links,i=>(c(),p("div",{class:"block__links__link",key:i.name},[l("div",zn,y(i.name),1),l("a",{href:i.url,target:"_blank",class:"link"},[ae(y(e.$t(i.title)),1),Hn],8,Vn)]))),128))])])):b("",!0)],64)}var Kn=Q(Nn,[["render",Jn]]);const Qn=K({name:"WikiBlock",props:{title:{type:String,required:!0},content:{type:String,required:!1,default:""},limited:{type:Boolean,default:!1}},setup(){const e=le();return{config:N,store:e}}}),Yn={class:"wiki-block"},Zn={class:"wiki__title"},Xn={class:"wiki__infos"},xn=l("div",{class:"wiki__infos__basics"},null,-1),eo=["innerHTML"],to={key:1,class:"wiki__infos__content wiki__limited"},so={key:0,class:"text-red-7"};function no(e,t,s,o,n,r){return c(),p("div",Yn,[l("div",Zn,y(e.$t(e.title)),1),l("div",Xn,[xn,e.limited?b("",!0):(c(),p("div",{key:0,class:"wiki__infos__content",innerHTML:e.content},null,8,eo)),e.limited?(c(),p("div",to,[e.store.RUNTIME_SHOW_API_ERROR_MESSAGE?(c(),p("span",so,y(e.config.RUNTIME_API_ERROR_MESSAGE),1)):b("",!0)])):b("",!0)])])}var oo=Q(Qn,[["render",no]]);const io=K({name:"CommonGoogleBreadcrumb",setup(){return{}}});function ro(e,t,s,o,n,r){return c(),R(pt,{to:"head"},[(c(),R(_t("script"),{type:"application/ld+json"},{default:ce(()=>[ae(' [ { "@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [ { "@type": "ListItem", "position": 1, "name": "Books", "item": "https://example.com/books" }, { "@type": "ListItem", "position": 2, "name": "Science Fiction", "item": "https://example.com/books/sciencefiction" }, { "@type": "ListItem", "position": 3, "name": "Award Winners" } ] }, { "@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [ { "@type": "ListItem", "position": 1, "name": "Literature", "item": "https://example.com/literature" }, { "@type": "ListItem", "position": 2, "name": "Award Winners" } ] }, { "@context": "https://schema.org", "@type": "NewsArticle", "headline": "Title of a News Article", "image": [ "https://example.com/photos/1x1/photo.jpg", "https://example.com/photos/4x3/photo.jpg", "https://example.com/photos/16x9/photo.jpg" ], "datePublished": "2015-02-05T08:00:00+08:00", "dateModified": "2015-02-05T09:20:00+08:00", "author": [ { "@type": "Person", "name": "Jane Doe", "url": "https://example.com/profile/janedoe123" }, { "@type": "Person", "name": "John Doe", "url": "https://example.com/profile/johndoe123" } ] } ] ')]),_:1}))])}var ao=Q(io,[["render",ro]]);const co=e=>{const t=Object.entries(kt);let s=e;return t.forEach(o=>{s=s.replaceAll(o[0],o[1])}),s},lo=e=>{const t=Object.entries($t);let s=e;return t.forEach(o=>{s=s.replaceAll(o[0],o[1])}),s},uo=e=>{const t=Object.entries(bt);let s=e;return t.forEach(o=>{s=s.replaceAll(o[0],o[1])}),s};var Me={replaceI18nZh:co,replaceI18nJa:lo,replaceI18nEn:uo};function _o(e){switch(e){case"../services/deprecated/DeprecatedSystemServices.ts":return H(()=>import("./DeprecatedSystemServices.c0d09c1c.js"),["assets/DeprecatedSystemServices.c0d09c1c.js","assets/index.5760d8ee.js","assets/index.4f99bc31.css"]);case"../services/Offline/OfflineSystemServices.ts":return H(()=>import("./OfflineSystemServices.1eb6b446.js"),["assets/OfflineSystemServices.1eb6b446.js","assets/index.5760d8ee.js","assets/index.4f99bc31.css"]);case"../services/Online/OnlineSystemServices.ts":return H(()=>import("./OnlineSystemServices.ed285198.js"),["assets/OnlineSystemServices.ed285198.js","assets/index.5760d8ee.js","assets/index.4f99bc31.css"]);default:return new Promise(function(t,s){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+e)))})}}function po(e){switch(e){case"../services/deprecated/DeprecatedWikiServices.ts":return H(()=>import("./DeprecatedWikiServices.fdc59771.js"),["assets/DeprecatedWikiServices.fdc59771.js","assets/index.5760d8ee.js","assets/index.4f99bc31.css"]);case"../services/Offline/OfflineWikiServices.ts":return H(()=>import("./OfflineWikiServices.0a268fb1.js"),["assets/OfflineWikiServices.0a268fb1.js","assets/index.5760d8ee.js","assets/index.4f99bc31.css","assets/_commonjsHelpers.294d03c4.js"]);case"../services/Online/OnlineWikiServices.ts":return H(()=>import("./OnlineWikiServices.5fd07b92.js"),["assets/OnlineWikiServices.5fd07b92.js","assets/index.5760d8ee.js","assets/index.4f99bc31.css"]);default:return new Promise(function(t,s){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+e)))})}}let _e=N.BUILD_OFFLINE_MODE&&N.BUILD_OFFLINE_SET_OFFLINE_MODE==="offline"?"Offline":"Online";const Ue=await po(`../services/${_e}/${_e}WikiServices.ts`),mo=_e==="Online"?await _o(`../services/${_e}/${_e}SystemServices.ts`):"",fo=K({name:"WikiPage",setup(){mt(()=>({title:`${N.BUILD_WINDOW_TITLE} - Document`}));const e=le(),t=Ye(),s=Ae(()=>t.name),o=T(t.params.id.toString()),n=T(),r=T(),{t:i,locale:a}=ft({useScope:"global"}),f=Ae(()=>t.name==="wikiComponent"?"component":t.name==="wikiDocument"?"document":"tag"),m=Ae(()=>f.value==="component"&&N.RUNTIME_SHOW_WIKI_COMPONENT_BUTTON_ADD),d=T([]),_=T(0),u=T(0),v=T(!1),B=T(!1),O=T(),D=async()=>{const $=await Ue.getWiki(f.value,o.value);n.value=$.page_title,$.result&&d.value.push({name:$.result_title,templates:[...$.result]}),$.result2&&d.value.push({name:$.result2_title,templates:[...$.result2]}),$.result3&&d.value.push({name:$.result3_title,templates:[...$.result3]}),d.value.forEach(I=>{I.templates.forEach(async h=>{const A=await Ue.getWikiTemplate(f.value,h.block_type,h.data_category,o.value,1);if(A.result===404){h.limited=!0;return}if(vt.isEncrypted(A)){h.limited=!0;return}h.block_type==="wiki"?a.value==="zh"?h.content=Me.replaceI18nZh(A.result):a.value==="ja"?h.content=Me.replaceI18nJa(A.result):h.content=Me.replaceI18nEn(A.result):h.block_type==="recommend"&&h.data_category==="documents"?h.content=A.result.documents:h.block_type==="recommend"&&h.data_category==="components"||h.block_type==="recommend"&&h.data_category==="issues"?h.content=A.result:h.block_type==="resource"&&h.data_category==="links"?h.content=A.result.links:h.block_type==="resource"&&h.data_category==="attachments"?h.content=A.result.attachments:h.block_type==="report"&&h.data_category==="report_list"&&(h.content=A.result)})})},L=async()=>{const $=await mo.getDevices();O.value=$.result.devices,O.value&&(O.value=O.value.map(I=>({...I,systems:I.systems.map(h=>({...h,selected:!1}))})))},g=$=>{_.value=$};let Y=[];const te=T(!1);let w;const Se=$=>{te.value=!0,w&&clearTimeout(w),$!==u.value&&Y[$].scrollIntoView({behavior:"smooth"}),u.value=$,w=setTimeout(()=>{te.value=!1},1e3)},Ie=$=>{$&&Y.push($)},me=()=>{te.value||Y.forEach($=>{window.scrollY>=$.offsetTop-150&&Number($.getAttribute("index"))>-1&&(u.value=Number($.getAttribute("index")))})},U=()=>{v.value=!v.value},F=async()=>{await D(),s.value==="wikiComponent"&&await L()},J=async()=>{if(!N.RUNTIME_OFFLINE_USE_DECRYPT_JS_ON_FOOTER_STAGING)await Ue.decryptWiki(d.value);else if(N.RUNTIME_OFFLINE_USE_DECRYPT_JS_ON_FOOTER_STAGING){let $=document.getElementById("load-script"),I=document.createElement("script");I.src="/crypto-js.min.js",$?.appendChild(I);let h=document.createElement("script");h.src="/ExternalDecrypt.js",$?.appendChild(h)}},k=async()=>{(await de.addTempBookcase(o.value)).result.success&&Fe.success(`${i("addSuccess")}`)};return ge(async()=>{r.value.innerText||await F(),window.addEventListener("scroll",me),B.value=!0,N.BUILD_OFFLINE_MODE&&e.offlineMode==="offline"&&N.RUNTIME_OFFLINE_ENABLE_DECRYPT_WIKI&&J()}),ht(()=>{window.removeEventListener("scroll",me)}),{wikiData:d,wikiType:f,nowPage:_,pageTitle:n,title:r,dataKey:o,nowSection:u,isShowDrawer:v,isLoaded:B,showComponentAddSystemButton:m,devices:O,routeName:s,buildConfig:N,pageInit:F,switchPage:g,scrollTo:Se,setRef:Ie,toggleDrawer:U,addBookList:k}}}),rt=e=>(ye("data-v-420d4e2e"),e=e(),we(),e),ho={class:"page-title-wrap"},go={class:"title row items-center",id:"pageTitle",ref:"title"},yo={class:"block__tabs"},wo=["onClick"],vo={key:1,class:"wiki-wrap"},ko={key:0,class:"sidebar"},$o={class:"sidebar-title"},bo=["onClick"],Eo=rt(()=>l("img",{src:"/images/icons/add.svg",alt:""},null,-1)),So=rt(()=>l("img",{src:"/images/icons/post_add.svg",alt:""},null,-1)),Io=["index"];function Do(e,t,s,o,n,r){const i=ao,a=ve("router-link"),f=oo,m=Kn,d=Rn,_=En,u=gn,v=on,B=Qs,O=Rs;return c(),p(C,null,[e.isLoaded&&e.buildConfig.BUILD_OFFLINE_MODE&&e.buildConfig.RUNTIME_OFFLINE_USE_GOOGLE_BREADCRUMB_LIST?(c(),R(i,{key:0})):b("",!0),l("div",{class:oe(["page-title",{"sidebar-style":e.nowPage!==0||!e.buildConfig.RUNTIME_SHOW_WIKI_COMPONENT_SIDEBAR}])},[l("div",ho,[l("div",go,[l("span",null,y(e.pageTitle),1)],512),Re(l("div",yo,[(c(!0),p(C,null,W(e.wikiData,(D,L)=>(c(),p("div",{class:oe(["tab",{active:L===e.nowPage}]),key:L,onClick:g=>e.switchPage(L)},y(e.$t(D.name)),11,wo))),128))],512),[[Ne,!e.buildConfig.BUILD_OFFLINE_MODE]])])],2),e.isLoaded?(c(),p("div",vo,[e.buildConfig.RUNTIME_SHOW_WIKI_COMPONENT_SIDEBAR?Re((c(),p("div",ko,[l("div",$o,y(e.$t("$i18n_menu_$i18n")),1),(c(!0),p(C,null,W(e.wikiData,(D,L)=>(c(),p("div",{key:L},[(c(!0),p(C,null,W(D.templates,(g,Y)=>(c(),p(C,{key:"side_"+g.block_id},[L===0?(c(),p("div",{key:0,class:oe(["sidebar-item",{active:Y===e.nowSection}]),onClick:te=>e.scrollTo(Y)},y(e.$t(g.block_name)),11,bo)):b("",!0)],64))),128))]))),128)),e.showComponentAddSystemButton?(c(),p("div",{key:0,class:"add-system",onClick:t[0]||(t[0]=(...D)=>e.toggleDrawer&&e.toggleDrawer(...D))},[Eo,l("span",null,y(e.$t("$i18n_addToSystemsList_$i18n")),1)])):b("",!0),!e.buildConfig.BUILD_OFFLINE_MODE&&e.routeName==="wikiDocument"&&e.buildConfig.RUNTIME_ENABLE_WIKI_DOCUMENT_BOOKCASE?(c(),p("div",{key:1,class:"add-bookcase",onClick:t[1]||(t[1]=(...D)=>e.addBookList&&e.addBookList(...D))},[So,l("span",null,y(e.$t("$i18n_addToBookList_$i18n")),1)])):b("",!0),!e.buildConfig.BUILD_OFFLINE_MODE&&e.routeName==="wikiDocument"&&e.buildConfig.RUNTIME_ENABLE_WIKI_DOCUMENT_DIRECTORY?(c(),R(a,{key:2,to:`/${e.$i18n.locale}/dir/${e.dataKey}`,class:oe(["rag-dir",{soloDir:!e.buildConfig.RUNTIME_ENABLE_WIKI_DOCUMENT_BOOKCASE}])},{default:ce(()=>[pe(gt,{name:"sym_o_forum",size:""}),l("span",null,y(e.$t("$i18n_Data_scope_conversation_$i18n")),1)]),_:1},8,["to","class"])):b("",!0)],512)),[[Ne,e.nowPage===0]]):b("",!0),(c(!0),p(C,null,W(e.wikiData,(D,L)=>Re((c(),p("div",{class:oe(["content",{"sidebar-style":e.nowPage!==0||!e.buildConfig.RUNTIME_SHOW_WIKI_COMPONENT_SIDEBAR}]),key:L},[(c(!0),p(C,null,W(D.templates,(g,Y)=>(c(),p("div",{class:"template",key:g.block_id,index:L===0?Y:-1,ref_for:!0,ref:e.setRef},[g.block_type==="wiki"?(c(),R(f,{key:0,content:g.content,title:g.block_name,limited:g.limited},null,8,["content","title","limited"])):b("",!0),g.block_type==="resource"&&g.data_category==="attachments"?(c(),R(m,{key:1,attachments:g.content,title:g.block_name,limited:g.limited,type:"attachments"},null,8,["attachments","title","limited"])):b("",!0),g.block_type==="resource"&&g.data_category==="links"?(c(),R(m,{key:2,links:g.content,title:g.block_name,limited:g.limited,type:"links"},null,8,["links","title","limited"])):b("",!0),g.block_type==="recommend"&&g.data_category==="components"?(c(),R(d,{key:3,components:g.content,title:g.block_name,limited:g.limited},null,8,["components","title","limited"])):b("",!0),g.block_type==="recommend"&&g.data_category==="issues"?(c(),R(_,{key:4,issues:g.content,title:g.block_name,limited:g.limited},null,8,["issues","title","limited"])):b("",!0),g.block_type==="recommend"&&g.data_category==="documents"?(c(),R(u,{key:5,documents:g.content,title:g.block_name,limited:g.limited},null,8,["documents","title","limited"])):b("",!0),g.block_type==="report"&&g.data_category==="report_list"?(c(),R(v,{key:6,reports:g.content,limited:g.limited},null,8,["reports","limited"])):b("",!0)],8,Io))),128))],2)),[[Ne,L===e.nowPage]])),128))])):b("",!0),e.routeName==="wikiComponent"?(c(),R(B,{key:2,isShowDrawer:e.isShowDrawer,devices:e.devices?e.devices:[],onToggleDrawer:e.toggleDrawer},null,8,["isShowDrawer","devices","onToggleDrawer"])):b("",!0),!e.buildConfig.BUILD_OFFLINE_MODE&&e.routeName==="wikiDocument"?(c(),R(O,{key:3})):b("",!0)],64)}var Fo=Q(fo,[["render",Do],["__scopeId","data-v-420d4e2e"]]);export{Fo as default};
